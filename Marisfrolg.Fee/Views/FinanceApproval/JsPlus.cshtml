<link rel="stylesheet" href="~/Content/print.css" />
<link href="~/Scripts/Viewer/viewer.min.css" rel="stylesheet" />
<script src="~/Scripts/Viewer/viewer.min.js"></script>

<style>
    .weui_maskNew {
        position: fixed;
        z-index: 9998;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        background: rgba(0, 0, 0, 0.6);
    }
</style>

<!--BEGIN 弹出层-->
<div class="weui_dialog_confirm weui_dialog_ours" id="dialogPrint" style="display: none; overflow-y: auto;">
    <div class="weui_mask">打印预览</div>
    <div class="weui_dialog weui_dialog_ours" style="font-family: 'Microsoft YaHei';">
        <div class="text-left " style="margin-left: 20px;"">
            <span id="btnPrint" onclick="printContent()" class="text-left" style="font-weight: bold; color: blue; cursor: pointer;">点击打印</span>
            <i class="icon iconfont btnClose " style="font-size: 25px; position: relative;margin-left:70%">&#xe600;</i>
        </div>
        <!-- 标题 -->
        <div id="printContainer" style="font-size: 12px; overflow-y: auto; margin-top: -30px;">
            <!-- A4内容开始 -->
            <div class="printPage" style="font-family: 'Microsoft YaHei'; overflow-y: auto; font-size: 12px;">
                <div>
                    <h4 class="text-center" style="font-weight: bold;" id="billType"></h4>
                </div>
                <table class="secionTop">
                    <tr class="line">
                        <td colspan="99"></td>
                    </tr>
                    <tr>
                        <td class="tableRow text-left">
                            <span id="billNo"></span>
                        </td>
                        <td class="tableRow">
                            <span class="text-right" id="Clerk"></span>
                        </td>
                    </tr>


                    <tr class="line">
                        <td colspan="99"></td>
                    </tr>
                    <tr>
                        <td class="tableRow text-left" colspan="99">
                            <span id="CompanyName"></span>
                        </td>
                    </tr>
                    <tr>
                        <td class="tableRow text-left" colspan="99">
                            <span id="Brand"></span>
                        </td>
                    </tr>
                    <tr>
                        <td class="tableRow text-left" colspan="99">
                            <span id="DepartmentName"></span>
                        </td>
                    </tr>
                    <tr>
                        <td class="tableRow text-left" colspan="99">
                            <span id="CostCenter"></span>
                        </td>
                    </tr>
                    <tr>
                        <td class="tableRow text-left" colspan="99">
                            <span id="Person"></span>
                        </td>
                    </tr>
                    <tr>
                        <td class="tableRow text-left" colspan="99">
                            <span id="DateTime"></span>
                        </td>
                    </tr>
                </table>
                <div class="secionMiddle">
                    <table class="tableborder">
                        <thead>
                            <tr>
                                <th>费用项</th>
                                <th>币种</th>
                                <th class="money">金额</th>
                                <th class="money">税额</th>
                            </tr>
                        </thead>
                        <tbody id="Content">
                        </tbody>
                    </table>
                    <table>
                        <tr>
                            <td class="tableRow text-left">
                                <span id="Remark"></span>
                            </td>
                        </tr>
                    </table>
                    <table id="DetailsRow">
                        <tr>
                            <td class="tableRow text-left">
                                <span id="Details"></span>
                            </td>
                        </tr>
                    </table>
                    <table id="ProviderRow">
                        <tr>
                            <td class="tableRow text-left">
                                <span id="ProviderName"></span>
                            </td>
                        </tr>

                    </table>
                    <table id="BankNameRow">
                        <tr>
                            <td class="tableRow text-left">
                                <span id="BankName"></span>
                            </td>
                        </tr>
                    </table>
                    <table id="SettlementTimeRow">
                        <tr>
                            <td class="tableRow text-left">
                                <span id="SettlementTime"></span>
                            </td>
                        </tr>
                    </table>



                </div>
                <div class="secionBottom">
                    <div class="text-left"><span>[特殊属性]</span></div>
                    <table class="table_spacial">
                        <tr class="line">
                            <td colspan="99"></td>
                        </tr>
                        <tr>
                            <td class="tableRow text-left">
                                <span style="" id="Funds"></span>
                            </td>
                            <td class="tableRow text-left">
                                <span style="" id="MarketDebt"></span>
                            </td>
                        </tr>
                        <tr>
                            <td class="tableRow text-left">
                                <span style="" id="BankDebt"></span>
                            </td>
                            <td class="tableRow text-left">
                                <span style="" id="Agent"></span>
                            </td>
                        </tr>
                        <tr>
                            <td class="tableRow text-left">
                                <span style="" id="deposit"></span>
                            </td>
                            <td class="tableRow text-left">
                                <span style="" id="MissBillPlus"></span>
                            </td>
                        </tr>
                    </table>
                    <div class="text-left" style=""><span>[审批流程]</span></div>
                    <table class="tableFlow">
                        <tr id="tbody">
                        </tr>
                        <tr id="tfoot">
                        </tr>
                        <tr id="ttime">
                        </tr>
                        <tr id="tremark" style="display: none">
                        </tr>
                    </table>

                    <div class="col-md-12" style="background-color: #F0FFFF;">
                        <ul id="photos" class="weui_uploader_files" style="margin-top: 5px; margin-left: -15px;">
                        </ul>
                    </div>
                </div>

                @*<div class="col-md-12 weui_dialog_ft" style="margin-top: 3px; background-color: #65c294" >
                    <a id="btnSubmit1" href="javascript:showPhoto('1');" style="background-color: #02940D; color: white;">通过</a>
                    <a id="btnSubmit2" href="javascript:showPhoto('0');" style="background-color: #F91961; color: white;">不通过</a>
                </div>*@
            </div>
            <!-- A4内容结束 -->
        </div>
        <div class="weui_dialog_ft" style="margin-top: 3px; background-color: #65c294" id="panelButtom">
            <a href="javascript:showPhoto('1');" style="background-color: #02940D; color: white;">通过</a>
            <a href="javascript:showPhoto('0');" style="background-color: #F91961; color: white;">不通过</a>
        </div>
    </div>
</div>


<div id="printPreView" style="width: 230mm; display: none;">
            <!-- A4内容开始 -->
            <div style="max-height: 298mm; max-width: 230mm; font-family: 'Microsoft YaHei'; font-size: 16px;">
                <div>
                    <h3 class="text-center" id="billType10"></h3>
                </div>

                <table class="secionTop">
                    <tr class="line">
                        <td colspan="99"></td>
                    </tr>
                    <tr>
                        <td class="tableRow">
                            <div id="barcodeTarget10" style="margin-left: -10px;"></div>
                        </td>
                        <td class="tableRow">
                            <span class="text-left" id="Clerk10"></span>
                        </td>
                    </tr>
                    <tr class="line">
                        <td colspan="99"></td>
                    </tr>
                    <tr>
                        <td class="tableRow text-left">
                            <span id="CompanyName10"></span>
                        </td>
                        <td class="tableRow text-left">
                            <span id="Brand10"></span>
                        </td>
                    </tr>
                    <tr>
                        <td class="tableRow text-left">
                            <span id="DepartmentName10"></span>
                        </td>
                        <td class="tableRow text-left">
                            <span id="CostCenter10"></span>
                        </td>
                    </tr>
                    <tr>
                        <td class="tableRow text-left">
                            <span id="Person10"></span>
                        </td>
                        <td class="tableRow text-left">
                            <span id="DateTime10"></span>
                        </td>
                    </tr>
                </table>

                <div class="secionMiddle">
                    <table class="tableborder">
                        <thead>
                            <tr>

                                <th>科目名称</th>
                                <th>币种</th>
                                <th class="money">金额</th>
                                <th class="money">税额</th>

                            </tr>
                        </thead>
                        <tbody id="Content10">
                        </tbody>
                    </table>
                    <table>
                        <tr>
                            <td class="tableRow text-left">
                                <span id="Remark10"></span>
                            </td>
                        </tr>
                    </table>
                    <table id="ProviderRow10">
                        <tr>
                            <td class="tableRow text-left">
                                <span id="ProviderName10"></span>
                            </td>
                        </tr>
                    </table>
                    <table>
                        <tr>
                            <td class="tableRow text-left">
                                <span id="BankName10"></span>
                            </td>
                        </tr>
                    </table>
                    <table id="DetailsRow10">
                        <tr>
                            <td class="tableRow text-left">
                                <span id="Details10"></span>
                            </td>
                        </tr>
                    </table>
                    <table id="SettlementTimeRow10">
                        <tr>
                            <td class="tableRow text-left">
                                <span id="SettlementTime10"></span>
                            </td>
                        </tr>
                    </table>
                </div>

                <div class="secionBottom">
                    <span class="text-left" style="float: left;">[特殊属性]</span>
                    <table style="width: 230mm; height: 25mm;">
                        <tr class="line">
                            <td colspan="99"></td>
                        </tr>
                        <tr>
                            <td class="text-left">
                                <span style="" id="Funds10"></span>
                            </td>
                            <td class="tableRow text-left">
                                <span style="" id="MarketDebt10"></span>
                            </td>
                        </tr>
                        <tr>
                            <td class="text-left">
                                <span style="" id="BankDebt10"></span>
                            </td>
                            <td class="text-left">
                                <span style="" id="Agent10"></span>
                            </td>
                        </tr>
                        <tr>
                            <td class="text-left">
                                <span style="" id="deposit10"></span>
                            </td>
                            <td class="tableRow text-left">
                                <span style="" id="MissBill10"></span>
                            </td>
                        </tr>
                    </table>


                    <div class="text-left" style="margin-top: 5mm;"><span>[审批流程]</span></div>
                    <table class="tableFlow">
                        <tr id="tbody10">
                        </tr>
                        <tr id="tfoot10">
                        </tr>
                    </table>

                </div>

            </div>
            <!-- A4内容结束 -->
        </div>


<!--关联数据弹出层-->
<div class="weui_dialog_confirm weui_dialog_ours" id="dialogPhoto" style="display: none; z-index: 9999;">
    <div class="weui_mask">打印预览</div>
    <div class="weui_dialog weui_dialog_ours">
        <div id="printData" class="printPage" style="font-size: 12px; overflow-y: auto;">
            <!-- A4内容开始 -->
            <div style="font-family: 'Microsoft YaHei'; font-size: 12px;">
                <div class="col-md-12">
                    <div class="col-md-4">
                    </div>
                    <div class="col-md-4">
                        <h4 class="text-center" style="font-weight: bold;">相关单据</h4>
                    </div>
                    <div class="col-md-4 text-right ">
                        <i class="icon iconfont" style="font-size: 25px;" onclick="CloseForm()">&#xe600;</i>
                    </div>
                </div>


                <div class="secionBottom">
                    <table class="tableFlow" id="ShowRelationData">
                        <tbody>
                            <tr>
                                <th>单号</th>
                                <th>单据类型</th>
                                <th>业务时间</th>
                                <th>报销方</th>
                                <th>金额</th>
                                <th>状态</th>
                            </tr>
                            <tr>
                                <td style="text-align: center">1111</td>
                                <td style="text-align: center">1111</td>
                                <td style="text-align: center">111</td>
                                <td style="text-align: center">1111</td>
                                <td style="text-align: center"></td>
                            </tr>
                    </table>
                </div>

            </div>
            <!-- A4内容结束 -->
        </div>
    </div>
</div>


<div class="weui_dialog_confirm" id="dialogRemark" style="display: none; background-color: #52a4a4">
    <div class="weui_maskNew"></div>
    <div class="weui_dialog" style="height: 130px;">
        <div class="weui_dialog_hd"><strong class="weui_dialog_title">填写审批意见</strong></div>
        <div class="weui_dialog_bd">
            <input class="weui_input" id="RemarkContent" style="color: red;" />
        </div>
        <div class="weui_dialog_ft">
            <a href="javascript:;" class="weui_btn_dialog default" onclick="HidePhoto()">取消</a>
            <a href="javascript:;" class="weui_btn_dialog primary" onclick="SubmitWorkFlow('1')">确定</a>
        </div>
    </div>
</div>

<ul id="photos1" class="weui_uploader_files" style="margin-top: 5px; margin-left: -15px; display: none">
</ul>
<script type="text/javascript">
    $(function () {
    });

    $("#photos").delegate("li", "click", function () {
        var url = $(this).attr("url");
        if (url.indexOf("pdf") > -1) {
            return;
        }
        var viewer = new Viewer(document.getElementById('photos1'), {
            url: 'data-original',
            zIndex: 9999,
            hide: function () {
                viewer.destroy();
            }
        });
        $("#photos1 li ").eq($(this).index()).find("img").click();
    })

    function HidePhoto() {
        $("#dialogRemark").hide();
    }

    function CloseForm() {
        $("#dialogPhoto").hide();
    }


    function FinancePDFShow(src, OriginalUrl) {
        if (src) {
            if (OriginalUrl) {
                window.open("../Scripts/PDFJS/build/generic/web/viewer.html?file=" + src + "&download=" + OriginalUrl);
            }
            else {
                window.open("../Scripts/PDFJS/build/generic/web/viewer.html?file=" + src);
            }
        }
    }

    var IsCommit = "";
    function showPhoto(work) {
        var remark = "";
        switch (work) {
            case "1":
                remark = "同意";
                IsCommit = "1";
                break;
            case "0":
                remark = "不同意";
                IsCommit = "0";
                break;
            default:
        }
        $("#RemarkContent").val(remark);
        $("#dialogRemark").show();
    }

    function FillBillNo(BillNo) {
        //填写打印内容
        $("#billNo").text("单号：" + BillNo);
        $("#barcodeTarget10").barcode(BillNo, "code128", { barWidth: 2.5, barHeight: 35 });
    }


    function InitPageData1(BillNo) {
        //填写打印内容
        $("#barcodeTarget").barcode(BillNo, "code128", { barWidth: 1.8, barHeight: 20 });
        $("#barcodeTarget10").barcode(BillNo, "code128", { barWidth: 2.5, barHeight: 35 });
    }


    function printContent() {
        $("#printPreView").css("display", "block");
        $("#printPreView").jqprint({
            debug: false, //如果是true则可以显示iframe查看效果（iframe默认高和宽都很小，可以再源码中调大），默认是false
            importCSS: true, //true表示引进原来的页面的css，默认是true。（如果是true，先会找$("link[media=print]")，若没有会去找$("link")中的css文件）
            printContainer: true, //表示如果原来选择的对象必须被纳入打印（注意：设置为false可能会打破你的CSS规则）。
            operaSupport: false//表示如果插件也必须支持歌opera浏览器，在这种情况下，它提供了建立一个临时的打印选项卡。默认是true
        });

        $("#printPreView").css("display", "none");
    }

    //绘制签名
    function printPersonSign() {

    }
    //图片加载错误
    function ImgError(obj) {
        $(obj).attr("onerror", null);
        $(obj).attr("src", "../Images/img_load_error.png");
    }

    //将还款单的显示变动
    function ChangeVersions1(BillNo, Type) {
        if (Type == 1) {
            return "费用报销单";
        }
        if (Type == 2) {
            return "付款通知书";
        }
        if (Type == 3) {
            return "借款单";
        }
        if (Type == 4) {
            if (BillNo.indexOf("FB") >= 0) {
                return "费用报销单(冲借款)";
            }
            if (BillNo.indexOf("HK") >= 0) {
                return "现金还款单";
            }
        }
        return "";
    }


    function SkipIntoBill(BillNo, Type) {
        $("#dialogPhoto").hide();
        $("#dialogPrint").hide();
        showDialog(BillNo, Type, "");
    }


    function FindRelationBill(itemName, DepartmentCode, CreateTime, BillNo) {
        $("#dialogPhoto").show();
        $.ajax({
            url: "@Url.Content("~/FinanceApproval/GetRelationBill/")",
            data: { itemName: itemName, DepartmentCode: DepartmentCode, CreateTime: CreateTime },
            contentType: "application/json; charset=utf-8",
            datatype: "json",
            type: "GET",
            success: function (result) {
                if (result) {
                    $("#ShowRelationData").children().remove();
                    result = JSON.parse(result);
                    var th = "<tr><th>单号</th><th>单据类型</th><th>业务时间</th><th>报销方</th><th>业务人</th><th>金额</th><th>状态</th></tr>";
                    $(th).appendTo("#ShowRelationData");
                    for (var i = 0; i < result.length; i++) {
                        if (result[i].BillNo == BillNo) {
                            continue;
                        }
                        var Brand = "";
                        if (result[i].PersonInfo.Brand != undefined && result[i].PersonInfo.Brand.length > 0) {
                            for (var k = 0; k < result[i].PersonInfo.Brand.length; k++) {
                                if (k < result[i].PersonInfo.Brand.length - 1) {
                                    Brand += result[i].PersonInfo.Brand[k] + ","
                                }
                                else {
                                    Brand += result[i].PersonInfo.Brand[k];
                                }
                            }
                        }
                        else {
                            Brand = "无记账品牌";
                        }

                        var DepartmentName = "";
                        if (result[i].PersonInfo.Shop) {
                            DepartmentName = result[i].PersonInfo.Department + "-" + result[i].PersonInfo.Shop;
                        }
                        else {
                            DepartmentName = result[i].PersonInfo.Department;
                        }
                        if (result[i].ApprovalPost == undefined) {
                            result[i].ApprovalPost = "";
                        }

                        var td = "<tr><td style=\"text-align: center;cursor:pointer;\"><a onclick=\"SkipIntoBill('" + result[i].BillNo + "','" + result[i].BillsType + "')\">" + result[i].BillNo + "</a></td><td style=\"text-align: center\">" + tagsMean(result[i].BillsType) + "</td> <td style=\"text-align: center\">" + result[i].TransactionDate.split('T')[0] + "</td><td style=\"text-align: center\">" + DepartmentName + "</td><td style=\"text-align: center;\">" + result[i].Owner + "</td><td style=\"text-align: center;\">" + result[i].TotalMoney + "</td><td style=\"text-align: center;\">" + ApprovalStatusMean(result[i].ApprovalStatus, result[i].ApprovalPost) + "</td></tr>"

                        $(td).appendTo("#ShowRelationData");
                    }
                }
                else {
                    submitMessageShow("无相应数据!", "error");
                }
            }
        })
    }


    //将信息填充到打印界面
    function SubmitDataInfo(BillNo, Type) {
        var Versions1 = ChangeVersions1(BillNo, Type);
        if (Versions1) {
            $("#billType").text(Versions1);
            $("#billType10").text(Versions1);
        }
        $("#ProviderRow").hide();
        $("#ProviderRow10").hide();
        $("#BankName").text("");
        $("#BankName10").text("");
        $.ajax({
            url: "@Url.Content("~/Print/GetDataFromBillNo/")",
            data: { BillNo: BillNo, Type: Type },
            contentType: "application/json; charset=utf-8",
            datatype: "json",
            type: "GET",
            success: function (result) {
                if (result) {
                    var result = JSON.parse(result);
                    var Brand = "";
                    if (result.PersonInfo.Brand != undefined && result.PersonInfo.Brand.length > 0) {
                        for (var k = 0; k < result.PersonInfo.Brand.length; k++) {
                            if (k < result.PersonInfo.Brand.length - 1) {
                                Brand += result.PersonInfo.Brand[k] + ","
                            }
                            else {
                                Brand += result.PersonInfo.Brand[k];
                            }
                        }
                    }
                    else {
                        Brand = "无记账品牌";
                    }

                    AjaxGetName(result.Creator, result.StringTime);
                    $("#CompanyName").text("公司名称：" + result.PersonInfo.Company + " ");
                    $("#Brand").text("发生品牌：" + Brand + "");
                    if (result.PersonInfo.Shop) {
                        $("#DepartmentName").text("报销方：" + result.PersonInfo.Department + "-" + result.PersonInfo.Shop + "");
                    }
                    else {
                        $("#DepartmentName").text("报销方：" + result.PersonInfo.Department + "");
                    }

                    //$("#DepartmentName").text("报销方：" + result.PersonInfo.Department + "" + result.PersonInfo.Shop == null ? "" : "-" + result.PersonInfo.Shop + "");
                    $("#CostCenter").text("成本中心：" + result.PersonInfo.CostCenter + "");
                    $("#Person").text("业务人：" + result.Owner + "");
                    $("#DateTime").text("业务日期：" + result.TransactionDate.split('T')[0] + "");
                    $("#Remark").text("事由：" + (result.Remark == null ? "" : " " + result.Remark) + "");

                    $("#Content tr").remove();
                    //真实打印在下////////////////////////
                    //$("#Clerk10").text("制单：" + employeeInfo.EmployeeName + " " + result.StringTime + "");
                    $("#CompanyName10").text("公司名称：" + result.PersonInfo.Company + " ");
                    $("#Brand10").text("发生品牌：" + Brand + "");
                    if (result.PersonInfo.Shop) {
                        $("#DepartmentName10").text("报销方：" + result.PersonInfo.Department + "-" + result.PersonInfo.Shop + "");
                    }
                    else {
                        $("#DepartmentName10").text("报销方：" + result.PersonInfo.Department + "");
                    }
                    $("#CostCenter10").text("成本中心：" + result.PersonInfo.CostCenter + "");
                    $("#Person10").text("业务人：" + result.Owner + "");
                    $("#DateTime10").text("业务日期：" + result.StringTime + "");
                    $("#Remark10").text("事由：" + (result.Remark == null ? "" : " " + result.Remark) + "");
                    $("#Content10 tr").remove();
                    //具有财务权限的显示
                    if (IsShowEdit) {
                        //费用项(预览界面)
                        for (var m = 0; m < result.Items.length; m++) {
                            if (result.Items[m].reason_code == null) {
                                result.Items[m].reason_code = "无";
                            }
                            var tr_line = "<tr><td>" + result.Items[m].name + "<input type=\"button\" value=\"查看\" style=\"width:20%;height:17px;float:right;color:#1e90ff;line-height:6px; \"onclick=\"FindRelationBill('" + result.Items[m].name + "','" + result.PersonInfo.DepartmentCode + "','" + result.CreateTime + "','" + result.BillNo + "')\"></td><td>" + result.Currency.Code + "</td> <td class=\"money\">" + result.Items[m].money.toFixed(2) + "</td><td class=\"money\">" + result.Items[m].taxmoney.toFixed(2) + "</td></tr>";
                            $(tr_line).appendTo($("#Content"));
                        }
                        //费用项(打印界面)
                        for (var m = 0; m < result.BillsItems.length; m++) {
                            if (result.BillsItems[m].reason_code == null) {
                                result.BillsItems[m].reason_code = "无";
                            }
                            var tr_line = "<tr><td>" + result.BillsItems[m].name + "</td><td>" + result.Currency.Code + "</td> <td class=\"money\">" + result.BillsItems[m].money.toFixed(2) + "</td><td class=\"money\">" + result.BillsItems[m].taxmoney.toFixed(2) + "</td></tr>";
                            $(tr_line).appendTo($("#Content10"));
                        }
                    }
                    else {
                        //费用项(预览界面)
                        for (var m = 0; m < result.Items.length; m++) {
                            if (result.Items[m].reason_code == null) {
                                result.Items[m].reason_code = "无";
                            }
                            var tr_line = "<tr><td>" + result.Items[m].name + "<input type=\"button\" value=\"查看\" style=\"width:20%;height:17px;float:right;color:#1e90ff;line-height:6px; \"onclick=\"FindRelationBill('" + result.Items[m].name + "','" + result.PersonInfo.DepartmentCode + "','" + result.CreateTime + "','" + result.BillNo + "')\"></td><td>" + result.Currency.Code + "</td> <td class=\"money\">" + result.Items[m].money.toFixed(2) + "</td><td class=\"money\">" + result.Items[m].taxmoney.toFixed(2) + "</td></tr>";
                            $(tr_line).appendTo($("#Content"));
                        }
                        //费用项(打印界面)
                        for (var m = 0; m < result.Items.length; m++) {
                            if (result.Items[m].reason_code == null) {
                                result.Items[m].reason_code = "无";
                            }
                            var tr_line = "<tr><td>" + result.Items[m].name + "</td><td>" + result.Currency.Code + "</td> <td class=\"money\">" + result.Items[m].money.toFixed(2) + "</td><td class=\"money\">" + result.Items[m].taxmoney.toFixed(2) + "</td></tr>";
                            $(tr_line).appendTo($("#Content10"));
                        }
                    }

                    //加载现金还款项目
                    if (result.Items.length == 0 && result.RefundType == "Cash") {
                        var tr_line = "<tr><td>现金还款</td><td>" + result.Currency.Code + "</td> <td class=\"money\">" + result.RealRefundMoney.toFixed(2) + "</td><td class=\"money\">0</td></tr>";
                        $(tr_line).appendTo($("#Content"));
                        $(tr_line).appendTo($("#Content10"));
                    }
                    $("<tr class=\"total\"><td colspan='2' class=\"money\">金额大写：" + num2rmb(result.TotalMoney) + "</td><td colspan='2' class=\"money\">" + Currency2Icon(result.Currency.Code) + "" + result.TotalMoney.toFixed(2) + "</td></tr>").appendTo($("#Content"));
                    $("<tr class=\"total\"><td colspan='2' class=\"money\">金额大写：" + num2rmb(result.TotalMoney) + "</td><td colspan='2' class=\"money\">" + Currency2Icon(result.Currency.Code) + "" + result.TotalMoney.toFixed(2) + "</td></tr>").appendTo($("#Content10"));

                    //付款通知书
                    if (result.PageName == "Notice") {
                        $("#Funds").text("是否活动经费：" + RetrunString(result.SpecialAttribute.Funds, "Funds") + "");
                        $("#Agent").text("是否代理商费用：" + RetrunString(result.SpecialAttribute.Agent, "Agent") + "");
                        $("#MissBill").text("是否回收发票：" + RetrunString(result.MissBill, "MissBill") + "");
                        $("#ProviderName").text("供应商：" + result.ProviderInfo.ProviderName + "");
                        if (result.ProviderInfo != null && result.ProviderInfo.BankName != null) {
                            $("#BankName").text("供应商银行信息：" + result.ProviderInfo.BankName + "(开户行)、"
                            + (result.ProviderInfo.BankNo == null ? "" : "" + result.ProviderInfo.BankNo) + "(账号)"
                            + (result.ProviderInfo.BankCode == null ? "" : "、" + result.ProviderInfo.BankCode + "(SWITF)、")
                            + (result.ProviderInfo.IBAN == null ? "" : "" + result.ProviderInfo.IBAN + "(IBAN)")
                            );
                        }

                        //总部
                        if (result.PersonInfo.IsHeadOffice == 1) {
                            $("#Agent").show();
                            $("#Agent10").show();
                        }
                        else {
                            $("#Agent").hide();
                            $("#Agent10").hide();
                        }

                        $("#ProviderRow").show();
                        $("#MissBill").parent().show();
                        $("#printContainer .secionBottom").children().eq(0).show();
                        $("#printContainer .secionBottom").children().eq(1).show();
                        $("#MarketDebt").parent().hide();
                        $("#BankDebt").parent().hide();
                        $("#Check").parent().hide();
                        $("#deposit").parent().hide();
                        $("#DetailsRow").hide();
                        $("#SettlementTimeRow").hide();
                        //真实打印在下////////////////////////
                        $("#Funds10").text("是否活动经费：" + RetrunString(result.SpecialAttribute.Funds) + "");
                        $("#Agent10").text("是否代理商费用：" + RetrunString(result.SpecialAttribute.Agent) + "");
                        $("#MissBill10").text("是否回收发票：" + RetrunString(result.MissBill) + "");
                        $("#ProviderName10").text("供应商：" + result.ProviderInfo.ProviderName + "");
                        if (result.ProviderInfo != null && result.ProviderInfo.BankName != null) {
                            $("#BankName10").text("供应商银行信息：" + result.ProviderInfo.BankName + "(开户行)、"
                          + (result.ProviderInfo.BankNo == null ? "" : "" + result.ProviderInfo.BankNo) + "(账号)"
                          + (result.ProviderInfo.BankCode == null ? "" : "、" + result.ProviderInfo.BankCode + "(SWITF)、")
                          + (result.ProviderInfo.IBAN == null ? "" : "" + result.ProviderInfo.IBAN + "(IBAN)")
                          );
                        }

                        $("#ProviderRow10").show();
                        $("#MissBill10").parent().show();
                        $("#printPreView .secionBottom").children().eq(0).show();
                        $("#printPreView .secionBottom").children().eq(1).show();
                        $("#MarketDebt10").parent().hide();
                        $("#BankDebt10").parent().hide();
                        $("#Check10").parent().hide();
                        $("#deposit10").parent().hide();
                        $("#DetailsRow10").hide();
                        $("#SettlementTimeRow10").hide();
                    }
                        //费用报销单
                    else if (result.PageName == "FeeBill") {
                        $("#Funds").text("是否活动经费：" + RetrunString(result.SpecialAttribute.Funds, "Funds") + "");
                        $("#MarketDebt").text("是否商场账扣：" + RetrunString(result.SpecialAttribute.MarketDebt, "MarketDebt") + "");
                        $("#BankDebt").text("是否银行账扣：" + RetrunString(result.SpecialAttribute.BankDebt, "BankDebt") + "");
                        $("#Agent").text("是否代理商费用：" + RetrunString(result.SpecialAttribute.Agent, "Agent") + "");
                        $("#Check").text("本单是否考核：" + RetrunString(result.SpecialAttribute.Check, "Check") + "");
                        $("#deposit").text("是否押金账扣：" + RetrunString(result.SpecialAttribute.Cash, "deposit") + "");
                        if (result.CollectionInfo != null && result.CollectionInfo.Bank != null) {
                            $("#BankName").text("收款人银行信息：" + result.CollectionInfo.Bank + "(银行)、"
                           + (result.CollectionInfo.City == null ? "" : "" + result.CollectionInfo.City) + "(城市)、"
                           + (result.CollectionInfo.CardCode == null ? "" : "" + result.CollectionInfo.CardCode) + "(卡号)、"
                           + (result.CollectionInfo.Name == null ? "" : "" + result.CollectionInfo.Name) + "(姓名)"
                       );
                        }
                        else {
                            $("#BankName").text("收款人银行信息：空")
                        }
                        if (result.CountTime != null && result.CountTime.CountStartTime.split('T')[0] != "0001-01-01" && result.CountTime.CountEndTime.split('T')[0] != "0001-01-01") {
                            $("#SettlementTimeRow").show();
                            $("#SettlementTimeRow10").show();
                            $("#SettlementTime").text("对应结算期：" + result.CountTime.CountStartTime.split('T')[0] + "到" + result.CountTime.CountEndTime.split('T')[0]);
                            $("#SettlementTime10").text("对应结算期：" + result.CountTime.CountStartTime.split('T')[0] + "到" + result.CountTime.CountEndTime.split('T')[0]);

                        }
                        else {
                            $("#SettlementTimeRow").hide();
                            $("#SettlementTimeRow10").hide();
                        }

                        //总部
                        if (result.PersonInfo.IsHeadOffice == 1) {
                            $("#Agent").show();
                            $("#Agent10").show();
                        }
                        else {
                            $("#Agent").hide();
                            $("#Agent10").hide();
                        }

                        $("#printContainer .secionBottom").children().eq(0).show();
                        $("#printContainer .secionBottom").children().eq(1).show();
                        $("#MarketDebt").parent().show();
                        $("#BankDebt").parent().show();
                        $("#Check").parent().show();
                        $("#deposit").parent().show();
                        $("#MissBill").parent().hide();
                        $("#DetailsRow").hide();
                        //真实打印在下////////////////////////
                        $("#Funds10").text("是否活动经费：" + RetrunString(result.SpecialAttribute.Funds) + "");
                        $("#MarketDebt10").text("是否商场账扣：" + RetrunString(result.SpecialAttribute.MarketDebt) + "");
                        $("#BankDebt10").text("是否银行账扣：" + RetrunString(result.SpecialAttribute.BankDebt) + "");
                        $("#Agent10").text("是否代理商费用：" + RetrunString(result.SpecialAttribute.Agent) + "");
                        $("#Check10").text("本单是否考核：" + RetrunString(result.SpecialAttribute.Check) + "");
                        $("#deposit10").text("是否押金账扣：" + RetrunString(result.SpecialAttribute.Cash) + "");
                        if (result.CollectionInfo != null && result.CollectionInfo.Bank != null) {
                            $("#BankName10").text("收款人银行信息：" + result.CollectionInfo.Bank + "(银行)、"
                          + (result.CollectionInfo.City == null ? "" : "" + result.CollectionInfo.City) + "(城市)、"
                          + (result.CollectionInfo.CardCode == null ? "" : "" + result.CollectionInfo.CardCode) + "(卡号)、"
                          + (result.CollectionInfo.Name == null ? "" : "" + result.CollectionInfo.Name) + "(姓名)"
                      );
                        }
                        else {
                            $("#BankName10").text("收款人银行信息：空")
                        }
                        $("#printPreView .secionBottom").children().eq(0).show();
                        $("#printPreView .secionBottom").children().eq(1).show();
                        $("#MarketDebt10").parent().show();
                        $("#BankDebt10").parent().show();
                        $("#Check10").parent().show();
                        $("#deposit10").parent().show();
                        $("#MissBill10").parent().hide();
                        $("#DetailsRow10").hide();
                    }
                        //借款单
                    else if (result.PageName == "BorrowBill") {
                        if (result.CollectionInfo.Bank != null) {
                            $("#BankName").text("收款人银行信息：" + result.CollectionInfo.Bank + "(银行)、"
                           + (result.CollectionInfo.City == null ? "" : "" + result.CollectionInfo.City) + "(城市)、"
                           + (result.CollectionInfo.CardCode == null ? "" : "" + result.CollectionInfo.CardCode) + "(卡号)、"
                           + (result.CollectionInfo.Name == null ? "" : "" + result.CollectionInfo.Name) + "(姓名)"
                           );
                            $("#BankName10").text("收款人银行信息：" + result.CollectionInfo.Bank + "(银行)、"
                           + (result.CollectionInfo.City == null ? "" : "" + result.CollectionInfo.City) + "(城市)、"
                           + (result.CollectionInfo.CardCode == null ? "" : "" + result.CollectionInfo.CardCode) + "(卡号)、"
                           + (result.CollectionInfo.Name == null ? "" : "" + result.CollectionInfo.Name) + "(姓名)"
                           );
                        }
                        else {
                            $("#BankName").text("收款人银行信息：空")
                            $("#BankName10").text("收款人银行信息：空")
                        }
                        if (true) {
                            $("#printContainer .secionBottom").children().eq(1).show();
                            $("#printPreView .secionBottom").children().eq(1).show();

                            $("#Funds").text("是否活动经费：" + RetrunString(result.SpecialAttribute.Funds, "Funds") + "");
                            $("#MarketDebt").text("是否商场账扣：" + RetrunString(result.SpecialAttribute.MarketDebt, "MarketDebt") + "");
                            $("#BankDebt").text("是否银行账扣：" + RetrunString(result.SpecialAttribute.BankDebt, "BankDebt") + "");
                            $("#Agent").text("是否代理商费用：" + RetrunString(result.SpecialAttribute.Agent, "Agent") + "");
                            $("#Check").text("本单是否考核：" + RetrunString(result.SpecialAttribute.Check, "Check") + "");
                            $("#deposit").text("是否押金账扣：" + RetrunString(result.SpecialAttribute.Cash, "deposit") + "");


                            $("#Funds10").text("是否活动经费：" + RetrunString(result.SpecialAttribute.Funds) + "");
                            $("#MarketDebt10").text("是否商场账扣：" + RetrunString(result.SpecialAttribute.MarketDebt) + "");
                            $("#BankDebt10").text("是否银行账扣：" + RetrunString(result.SpecialAttribute.BankDebt) + "");
                            $("#Agent10").text("是否代理商费用：" + RetrunString(result.SpecialAttribute.Agent) + "");
                            $("#Check10").text("本单是否考核：" + RetrunString(result.SpecialAttribute.Check) + "");
                            $("#deposit10").text("是否押金账扣：" + RetrunString(result.SpecialAttribute.Cash) + "");


                            $("#MissBill").parent().hide();
                            $("#MissBill10").parent().hide();
                            //总部
                            if (result.PersonInfo.IsHeadOffice == 1) {
                                $("#Agent").show();
                                $("#Agent10").show();
                            }
                            else {
                                $("#Agent").hide();
                                $("#Agent10").hide();
                            }
                        }
                        else {
                            $("#printContainer .secionBottom").children().eq(1).hide();
                            $("#printPreView .secionBottom").children().eq(1).hide();
                        }

                        $("#printContainer .secionBottom").children().eq(0).hide();
                        //$("#printContainer .secionBottom").children().eq(1).hide();
                        $("#DetailsRow").hide();
                        //真实打印在下////////////////////////
                        $("#printPreView .secionBottom").children().eq(0).hide();
                        //$("#printPreView .secionBottom").children().eq(1).hide();
                        $("#DetailsRow10").hide();
                        $("#SettlementTimeRow").hide();
                        $("#SettlementTimeRow10").hide();
                    }
                        //现金还款单
                    else if (result.PageName == "RefundBill" && result.RefundType == "Cash") {
                        $("#printContainer .secionBottom").children().eq(0).hide();
                        $("#printContainer .secionBottom").children().eq(1).hide();
                        $("#DetailsRow").show();
                        $("#Details").text("借款单号为:" + result.BorrowBillNo);

                        //真实打印在下////////////////////////
                        $("#printPreView .secionBottom").children().eq(0).hide();
                        $("#printPreView .secionBottom").children().eq(1).hide();
                        $("#DetailsRow10").show();
                        $("#Details10").text("借款单号为:" + result.BorrowBillNo);
                        $("#SettlementTimeRow").hide();
                        $("#SettlementTimeRow10").hide();
                    }
                        //费用还款单
                    else if (result.PageName == "RefundBill") {
                        $("#Funds").text("是否活动经费：" + RetrunString(result.SpecialAttribute.Funds, "Funds") + "");
                        $("#MarketDebt").text("是否商场账扣：" + RetrunString(result.SpecialAttribute.MarketDebt, "MarketDebt") + "");
                        $("#BankDebt").text("是否银行账扣：" + RetrunString(result.SpecialAttribute.BankDebt, "BankDebt") + "");
                        $("#Agent").text("是否代理商费用：" + RetrunString(result.SpecialAttribute.Agent, "Agent") + "");
                        $("#Check").text("本单是否考核：" + RetrunString(result.SpecialAttribute.Check, "Check") + "");
                        $("#deposit").text("是否押金账扣：" + RetrunString(result.SpecialAttribute.Cash, "deposit") + "");
                        $("#Details").text("借款单号为:" + result.BorrowBillNo);

                        $("#printContainer .secionBottom").children().eq(0).show();
                        $("#printContainer .secionBottom").children().eq(1).show();
                        $("#MarketDebt").parent().show();
                        $("#BankDebt").parent().show();
                        $("#Check").parent().show();
                        $("#deposit").parent().show();
                        $("#MissBill").parent().hide();
                        $("#DetailsRow").show();

                        if (result.CountTime != null && result.CountTime.CountStartTime.split('T')[0] != "0001-01-01" && result.CountTime.CountEndTime.split('T')[0] != "0001-01-01") {
                            $("#SettlementTimeRow").show();
                            $("#SettlementTimeRow10").show();
                            $("#SettlementTime").text("对应结算期：" + result.CountTime.CountStartTime.split('T')[0] + "到" + result.CountTime.CountEndTime.split('T')[0]);
                            $("#SettlementTime10").text("对应结算期：" + result.CountTime.CountStartTime.split('T')[0] + "到" + result.CountTime.CountEndTime.split('T')[0]);

                        }
                        else {
                            $("#SettlementTimeRow").hide();
                            $("#SettlementTimeRow10").hide();
                        }


                        //总部
                        if (result.PersonInfo.IsHeadOffice == 1) {
                            $("#Agent").show();
                            $("#Agent10").show();
                        }
                        else {
                            $("#Agent").hide();
                            $("#Agent10").hide();
                        }

                        //真实打印在下////////////////////////
                        $("#Funds10").text("是否活动经费：" + RetrunString(result.SpecialAttribute.Funds) + "");
                        $("#MarketDebt10").text("是否商场账扣：" + RetrunString(result.SpecialAttribute.MarketDebt) + "");
                        $("#BankDebt10").text("是否银行账扣：" + RetrunString(result.SpecialAttribute.BankDebt) + "");
                        $("#Agent10").text("是否代理商费用：" + RetrunString(result.SpecialAttribute.Agent) + "");
                        $("#Check10").text("本单是否考核：" + RetrunString(result.SpecialAttribute.Check) + "");
                        $("#deposit10").text("是否押金账扣：" + RetrunString(result.SpecialAttribute.Cash) + "");
                        $("#Details10").text("借款单号为:" + result.BorrowBillNo);

                        $("#printPreView .secionBottom").children().eq(0).show();
                        $("#printPreView .secionBottom").children().eq(1).show();
                        $("#MarketDebt10").parent().show();
                        $("#BankDebt10").parent().show();
                        $("#Check10").parent().show();
                        $("#deposit10").parent().show();
                        $("#MissBill10").parent().hide();
                        $("#DetailsRow10").show();
                    }

                    if (result.Photos != null && result.Photos.length > 0) {
                        //加载图片
                        $("#photos").children().remove();
                        $("#photos1").children().remove();
                        for (var j = 0; j < result.Photos.length; j++) {
                            var newguid = newGuid().toString();
                            var img;
                            if (result.Photos[j].url.indexOf("pdf") > -1) {
                                img = ("<li id=\"" + newguid + "\" " +
                                " class=\"invoicePhoto\" style=\"background-image:url(../Content/Images/PDF.jpg)\" url=\"" + result.Photos[j].url + "\" filename=\"" + result.Photos[j].filename + "\"  onclick=\"FinancePDFShow('" + result.Photos[j].url + "','" + result.Photos[j].OriginalUrl + "')\" \">"
                                + "<img width='100%' height='100%' src='../Content/Images/PDF.jpg'  />"
                                + "</li>");
                            }
                            else {
                                img = ("<li id=\"" + newguid + "\" " +
                                 " class=\"invoicePhoto\" style=\"background-image:url(" + result.Photos[j].url + ")\" url=\"" + result.Photos[j].url + "\" filename=\"" + result.Photos[j].filename + "  \">"
                                 + "<img width='100%' height='100%' src='" + result.Photos[j].url + "' onerror='ImgError(this)' data-original=\"" + result.Photos[j].url + "\" />"
                                 + "</li>");

                            }
                            $("#photos").append(img);
                            $("#photos1").append(img);
                        }
                    }
                }
            }
        });
    }

    function RetrunString(val, model) {
        if (val == "0") {
            if (model != undefined && model != "") {
                $("#" + model).css("color", "black");
            }
            return "否";
        }
        else if (val == "1") {
            if (model != undefined && model != "") {
                $("#" + model).css("color", "#CC3299");
            }
            return "是"
        }
    }

    function ChangeVersions2(Type) {
        switch (Type) {
            case "FeeBill":
                return 1;
            case "NoticeBill":
                return 2;
            case "BorrowBill":
                return 3;
            case "RefundBill":
                return 4;
            default:
        }
    }

    function showDialog(BillNo, Type, AssignmentID) {
        if (AssignmentID) {
            $("#editValue").attr("code", AssignmentID);
            $("#editValue").attr("BillNo", BillNo);
            $("#panelButtom").show();
        }
        else {
            $("#panelButtom").hide();
        }
        var $dialog = $('#dialogPrint');
        $dialog.show();
        Type = ChangeVersions2(Type);
        FillBillNo(BillNo);   //填写打印内容
        // printPersonSign();        //绘制签名
        SubmitDataInfo(BillNo, Type);  //将信息填充到打印界面
        GetWorkFlow(BillNo, Type);  //获取流程实例
        $dialog.find('.weui_btn_dialog').one('click', function () {
            $dialog.hide();
            $("body").css("overflow", "auto");
            jinzhi = 1;
        });
        $(".btnClose").one('click', function () {
            $dialog.hide();
            $("body").css("overflow", "auto");
            jinzhi = 1;
        });
        $("body").css("overflow", "hidden");
        jinzhi = 0;
    }

    function GetPrintList(tags, val) {
        $.ajax({
            url: "@Url.Content("~/FinanceApproval/GetMyProcess/")",
            data: { Type: tags, Time: val },
            contentType: "application/json; charset=utf-8",
            datatype: "json",
            type: "GET",
            success: function (result) {
                $("#vipData tr").children().remove();
                if (result) {
                    result = JSON.parse(result);
                    if (result != null && result.length > 0) {
                        for (var i = 0; i < result.length; i++) {
                            var billtype;
                            if (tags == "1") {
                                billtype = "费用报销单";
                            }
                            else if (tags == "2") {
                                billtype = "付款通知书";
                            }
                            else if (tags == "3") {
                                billtype = "借款单";
                            }
                            else if (tags == "4") {
                                billtype = "还款单";
                            }
                            $("#billType").text(billtype);
                            $("<tr><td><a onclick=\"GetVipDetail(this,'" + result[i].BillNo + "')\" style='color:blue;cursor:pointer;'>" + result[i].BillNo + "</a></td><td>"
                                + billtype + "</td><td>"
                                + result[i].Owner + "</td><td>"
                                + result[i].TotalMoney + "</td><td>"
                                + result[i].StringTime + "</td><td>"
                                + ApprovalStatusMean(result[i].ApprovalStatus) + "</td>"
                                + "<td style=\"text-align:center;\"><a onclick=\"showEditDialog('" + result[i].BillNo + "','" + tags + "')\" style='color:blue;cursor:pointer;'>" + '编辑' + "</a>&nbsp;<a onclick=\"showDialog('" + result[i].BillNo + "','" + tags + "','" + result[i].AssignmentID + "')\" style='color:blue;cursor:pointer;'>" + '审批' + "</a></td><tr>").appendTo($("#vipData"));
                        }
                    }
                }
            }
        });
    }


    function showEditDialog(BillNo, Type) {
        Type = ChangeVersions2(Type);
        EditViewLoadDate(BillNo, Type);//加载编辑数据
    }

    //单据详情
    function GetVipDetail(obj, mobile) {
        var url = "@Url.Content("~/Print/BillDetails")?NO=" + mobile;
        $(obj).parent().powerFloat({
            width: "300px",
            eventType: "click",
            target: url,

            targetMode: "ajax"
        });
    }
    //获取流程实例
    function GetWorkFlow(BillNo, Type) {
        $("#tremark").hide();
        $.ajax({
            url: "@Url.Content("~/Print/GetWorkFlowList/")",
            data: { BillNo: BillNo, Type: Type },
            contentType: "application/json; charset=utf-8",
            datatype: "json",
            type: "GET",
            success: function (result) {
                $("#tfoot td").text("");
                $("#ttime td").text("");
                $("#tremark td").text("");
                $("#tfoot10 td").text("");
                if (result) {
                    $("#tbody").children().remove();
                    $("#tfoot").children().remove();
                    $("#ttime").children().remove();
                    $("#tremark").children().remove();
                    $("#tbody10").children().remove();
                    $("#tfoot10").children().remove();
                    var result = JSON.parse(result);
                    for (var i = 0; i < result.length; i++) {
                        $("<th>" + result[i].Description + "</th>").appendTo($("#tbody"));
                        $("<th>" + result[i].Description + "</th>").appendTo($("#tbody10"));
                        var personName = "";
                        var mytime = "";
                        var Remark = "";
                        for (var j = 0; j < result[i].PersonName.length; j++) {
                            if (result[i].PersonName[j].indexOf("-") >= 0) {
                                result[i].PersonName[j] = result[i].PersonName[j].split('-')[0];
                            }

                            if (j < result[i].PersonName.length - 1) {
                                personName += result[i].PersonName[j] + "(" + KeyWorkSetCN(result[i].KeyWord[j]) + "),"
                            }
                            else {
                                personName += result[i].PersonName[j] + "(" + KeyWorkSetCN(result[i].KeyWord[j]) + ")"
                            }
                            //if (result[i].Description.indexOf("市场发展中心") >= 0) {
                            //    if (j < result[i].PersonName.length - 1) {
                            //        personName += "(" + KeyWorkSetCN(result[i].KeyWord[j]) + "),"
                            //    }
                            //    else {
                            //        personName += "(" + KeyWorkSetCN(result[i].KeyWord[j]) + ")"
                            //    }
                            //}
                            //else {
                            //    if (j < result[i].PersonName.length - 1) {
                            //        personName += result[i].PersonName[j] + "(" + KeyWorkSetCN(result[i].KeyWord[j]) + "),"
                            //    }
                            //    else {
                            //        personName += result[i].PersonName[j] + "(" + KeyWorkSetCN(result[i].KeyWord[j]) + ")"
                            //    }
                            //}

                            if (j < result[i].StringTime.length - 1) {
                                mytime += result[i].StringTime[j] + ",";
                            }
                            else {
                                mytime += result[i].StringTime[j];
                            }
                            if (result[i].Remark) {
                                $("#tremark").show();
                                Remark = result[i].Remark;
                            }
                        }
                        $("<td  style=\"text-align:center\">" + personName + "</td>").appendTo($("#tfoot"));
                        $("<td  style=\"text-align:center\">" + personName + "</td>").appendTo($("#tfoot10"));
                        $("<td  style=\"text-align:center\">" + mytime + "</td>").appendTo($("#ttime"));
                        $("<td  style=\"text-align:center\">" + Remark + "</td>").appendTo($("#tremark"));
                    }
                }
            }
        })
    };
    function KeyWorkSetCN(keyword) {
        if (keyword == "1") {
            return "通过";
        }
        if (keyword == "2") {
            return "驳回";
        }
        if (keyword == "0") {
            return "拒绝";
        }
    }

    function AjaxGetName(Creator, StringTime) {
        $.ajax({
            url: "@Url.Content("~/Home/AjaxGetName/")",
            data: { NO: Creator },
            contentType: "application/json; charset=utf-8",
            datatype: "json",
            type: "GET",
            success: function (result) {
                $("#Clerk").text("制单：" + result + " " + StringTime + "");
                $("#Clerk10").text("制单：" + result + " " + StringTime + "");
            }
        })
    }

    //提交审批(跟单据类型无关)
    function SubmitWorkFlow() {
        var BillNo = $("#editValue").attr("BillNo");
        var mean = "";
        if (IsCommit == "1") {
            mean = "审批成功";
        }
        else if (IsCommit == "0") {
            mean = "已拒绝";
        }
        var work = IsCommit;
        $.ajaxSetup({
            async: false
        });
        $.ajax({
            url: "@Url.Content("~/Home/SubmitWorkFlowList/")",
            data: { AssignmentID: $("#editValue").attr("code"), ActionName: work, Remark: $("#RemarkContent").val() },
            contentType: "application/json; charset=utf-8",
            datatype: "json",
            type: "GET",
            async: false,
            success: function (result) {
                if (result) {
                    $("#ShowBillStatus").text("单号" + BillNo + "" + mean + "");
                    submitMessageShow("审批已完成!");
                    setTimeout(function () {
                        tagClickSearchBill(null);//延迟刷新数据，等WF系统分配
                    }, 2000);
                }
                else {
                    submitMessageShow("失败!", "error");
                }
            }
        })
        $.ajaxSetup({
            async: true
        });
        $("#dialogRemark").hide();
        $("#dialogPrint").hide();
    };
    function newGuid() {
        var guid = "";
        for (var i = 1; i <= 32; i++) {
            var n = Math.floor(Math.random() * 16.0).toString(16);
            guid += n;
            if ((i == 8) || (i == 12) || (i == 16) || (i == 20))
                guid += "-";
        }
        return guid;
    }
</script>

@Html.Partial("~/Views/FinanceApproval/EditView.cshtml")
